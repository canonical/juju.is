{% extends "base.html" %}

{% block meta %}
  {{ super() }}
  <meta name="robots" content="noindex" />
{% endblock %}

{% block title %}Documentation search results{% endblock %}
{% block meta_title %}Documentation search results{% endblock %}
{% block page_class %}docs{% endblock %}
{% block content_class %}l-docs-wrapper{% endblock %}

{% block content %}

<section id="search-docs" class="p-strip--light is-shallow">
  <div class="u-fixed-width">
    <form class="p-search-box u-no-margin--bottom" action="/docs/search">
      <input type="search" class="p-search-box__input" name="q" {% if query %}value="{{ query }}" {% endif %}
        placeholder="Search documentation" required />
      <button type="button" class="p-search-box__reset" alt="reset"
        onclick="this.previousElementSibling.value = '';this.previousElementSibling.focus()">
        <i class="p-icon--close">Reset</i>
      </button>
      <button type="submit" class="p-search-box__button">
        <i class="p-icon--search">Search</i>
      </button>
    </form>
  </div>
</section>

{% if sorted_results %}
<section class="p-strip is-shallow">
  <div class="u-fixed-width">
    <h1 class="p-heading--2">
      We've found these results for your search: <strong>"{{ query }}"</strong>
    </h1>
    <ul class="p-list">
      {% for result in sorted_results[:20] %}
      <li class="p-list__item">
        <h5>
          <a href="{{ result.url }}" target="_blank">
            {{ result.title }}
          </a>&nbsp;
          {% set search_path = "search.html" if result.domain in ["pythonlibjuju.readthedocs.io", "ops.readthedocs.io"]
          else "search/" %}
          <a href="https://{{ result.domain }}/en/latest/{{ search_path }}?q={{ query }}" target="_blank" class="p-chip is-inline">
            <span class="p-chip__value">{{ domain_info.get(result.domain, {}).get("title", result.domain) }}</span>
          </a>
        </h5>
        <p>{{ result.short_content }}</p>
      </li>
      {% endfor %}
    </ul>
  </div>
</section>
{% else %}
<section class="p-strip--shallow">
  <div class="row">
    <div class="u-fixed-width">
      <h1 class="p-heading--2">
        We haven't found any results for your search: <strong>"{{ query }}"</strong>.
      </h1>
    </div>
    <div class="col-6">
      <h3>Why not try widening your search?</h3>
      <p>You can do this by:</p>
      <ul class="p-list">
        <li class="p-list__item is-ticked">Adding alternative words or phrases</li>
        <li class="p-list__item is-ticked">Using individual words instead of phrases</li>
        <li class="p-list__item is-ticked">Trying a different spelling</li>
      </ul>
    </div>
    <div class="col-6">
      <h3>Still no luck?</h3>
      <ul class="p-list">
        <li class="p-list__item is-ticked"><a href="/docs">Visit jaas.io/docs</a></li>
        <li class="p-list__item is-ticked"><a href="https://discourse.charmhub.io">Ask on the forum</a></li>
      </ul>
    </div>
  </div>
</section>
{% endif %}
{% endblock content %}

